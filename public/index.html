<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ActivityPub Relay</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>ActivityPub Relay</h1>
                <p class="subtitle">連合型SNSをつなぐリレーサーバー</p>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">
                🌙
            </button>
        </div>

        <div class="section">
            <h2>このリレーについて</h2>
            <p>このリレーサーバーは、Mastodon、Misskey、Pleroma などの ActivityPub 対応インスタンス同士を接続し、タイムラインを豊かにするためのサービスです。</p>
            <p>リレーに接続することで、他のインスタンスの公開投稿があなたのインスタンスに配信されるようになります。</p>
        </div>

        <div class="section">
            <h2>接続方法</h2>

            <h3>Mastodon</h3>
            <ol>
                <li>管理者権限でインスタンスにログイン</li>
                <li>「管理」→「リレー」に移動</li>
                <li>以下のエンドポイントを入力して「保存して有効化」をクリック</li>
            </ol>
            <div class="info-box">
                <code class="relay-inbox-endpoint">https://your-relay-domain.com/inbox</code>
            </div>

            <h3>Misskey / Firefish</h3>
            <ol>
                <li>管理者権限でインスタンスにログイン</li>
                <li>「コントロールパネル」→「リレー」に移動</li>
                <li>以下のエンドポイントを入力して「追加」をクリック</li>
            </ol>
            <div class="info-box">
                <code class="relay-inbox-endpoint">https://your-relay-domain.com/inbox</code>
            </div>

            <h3>Pleroma / Akkoma</h3>
            <ol>
                <li>管理者権限でインスタンスにログイン</li>
                <li>「AdminFE」→「Settings」→「Relays」に移動</li>
                <li>以下のエンドポイントを入力して追加</li>
            </ol>
            <div class="info-box">
                <code class="relay-actor-endpoint">https://your-relay-domain.com/actor</code>
            </div>
        </div>

        <div class="section">
            <h2>利用規約</h2>
            <p>このリレーを利用する場合、以下の点にご留意ください。</p>
            <ul>
                <li>リレーへの接続申請は管理者による承認が必要な場合があります</li>
                <li>スパムや違法コンテンツを配信するインスタンスは予告なく遮断される場合があります</li>
                <li>リレーサービスの可用性は保証されません</li>
            </ul>
        </div>

        <div class="section">
            <h2>技術情報</h2>
            <p><strong>プロトコル:</strong> ActivityPub</p>
            <p><strong>ソフトウェア:</strong> <a href="https://github.com/mattyatea/ActivityPub-Relay-Bun" target="_blank">ActivityPub-Relay-Bun</a></p>
            <p><strong>Actor エンドポイント:</strong> <code>/actor</code></p>
            <p><strong>Inbox エンドポイント:</strong> <code>/inbox</code></p>
        </div>

        <div class="section">
            <h2>お問い合わせ</h2>
            <p>リレーの利用に関するご質問やお問い合わせは、管理者までご連絡ください。</p>
        </div>
    </div>

    <script>
        // テーマ管理
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');

            if (body.classList.contains('dark-mode')) {
                body.classList.remove('dark-mode');
                body.classList.add('light-mode');
                themeToggle.textContent = '🌙';
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.remove('light-mode');
                body.classList.add('dark-mode');
                themeToggle.textContent = '☀️';
                localStorage.setItem('theme', 'dark');
            }
        }

        // 初期テーマ設定
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const themeToggle = document.getElementById('themeToggle');

            if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                document.body.classList.add('dark-mode');
                themeToggle.textContent = '☀️';
            } else {
                document.body.classList.add('light-mode');
                themeToggle.textContent = '🌙';
            }
        }

        // ページ読み込み時にテーマを初期化
        initTheme();

        // 現在のホストを使ってエンドポイントを表示
        document.addEventListener('DOMContentLoaded', function() {
            const host = window.location.host;
            const inboxEndpoints = document.querySelectorAll('.relay-inbox-endpoint');
            const actorEndpoints = document.querySelectorAll('.relay-actor-endpoint');

            inboxEndpoints.forEach(el => {
                el.textContent = `https://${host}/inbox`;
            });

            actorEndpoints.forEach(el => {
                el.textContent = `https://${host}/actor`;
            });
        });
    </script>
</body>
</html>
